# Environment Configuration for PRODUCTION
# Copy this file to terraform.tfvars and fill in your values
# terraform.tfvars is in .gitignore, so your sensitive data won't be committed
# IMPORTANT: For production, consider using Key Vault or environment variables for sensitive data

environment  = "prod"
project_name = "ecare"

#------------------------------------------------------------------------------
# Monitoring Configuration
#------------------------------------------------------------------------------
log_analytics_sku            = "PerGB2018"
log_analytics_retention_days = 90
application_insights_type    = "web"

#------------------------------------------------------------------------------
# Storage Configuration
#------------------------------------------------------------------------------
storage_account_tier                         = "Standard"
storage_replication_type                     = "GRS"  # Geo-redundant for PROD
storage_containers                           = ["app-data", "logs", "backups"]
storage_enable_versioning                    = true
storage_enable_soft_delete_blob              = true
storage_blob_soft_delete_retention_days      = 30
storage_enable_soft_delete_container         = true
storage_container_soft_delete_retention_days = 30

#------------------------------------------------------------------------------
# Key Vault Configuration
#------------------------------------------------------------------------------
key_vault_sku                       = "premium"  # Premium for PROD
key_vault_purge_protection_enabled  = true  # Enable for PROD
key_vault_soft_delete_retention_days = 90

#------------------------------------------------------------------------------
# ACR Configuration
#------------------------------------------------------------------------------
acr_sku                     = "Premium"
acr_zone_redundancy_enabled = true  # Enable for PROD
acr_retention_days          = 30

#------------------------------------------------------------------------------
# PostgreSQL Configuration
#------------------------------------------------------------------------------
postgresql_version                       = "15"
postgresql_sku_name                      = "GP_Standard_D2s_v3"  # General Purpose for PROD
postgresql_storage_mb                    = 131072  # 128 GB
postgresql_backup_retention_days         = 35  # Maximum retention
postgresql_geo_redundant_backup_enabled  = true  # Enable for PROD
postgresql_high_availability_enabled     = true  # Enable HA for PROD
postgresql_high_availability_mode        = "ZoneRedundant"
postgresql_admin_username                = "psqladmin"
# RECOMMENDED: Use environment variable for production passwords
# Set: export TF_VAR_postgresql_admin_password="YourSecurePassword123!"
# Or use Key Vault to retrieve password dynamically
postgresql_admin_password                = "CHANGE_ME_YourSecurePassword123!"

#------------------------------------------------------------------------------
# Service Bus Configuration
#------------------------------------------------------------------------------
service_bus_sku            = "Premium"  # Premium for PROD
service_bus_capacity       = 2  # 2 messaging units for PROD
service_bus_zone_redundant = true  # Enable for PROD

#------------------------------------------------------------------------------
# AKS Configuration
#------------------------------------------------------------------------------
aks_kubernetes_version               = null  # Use latest stable version
aks_sku_tier                         = "Standard"
aks_network_plugin                   = "azure"
aks_network_policy                   = "azure"
aks_service_cidr                     = "10.2.0.0/16"
aks_dns_service_ip                   = "10.2.0.10"

# System node pool
aks_system_node_pool_vm_size         = "Standard_D2s_v3"
aks_system_node_pool_node_count      = 3
aks_system_node_pool_os_disk_size_gb = 128

# User node pool
aks_user_node_pool_enabled           = true
aks_user_node_pool_vm_size           = "Standard_D2s_v3"
aks_user_node_pool_min_count         = 3  # Higher minimum for PROD
aks_user_node_pool_max_count         = 10  # Higher maximum for PROD
aks_user_node_pool_os_disk_size_gb   = 128
aks_enable_auto_scaling              = true

# Features
aks_oidc_issuer_enabled              = true
aks_workload_identity_enabled        = true
aks_azure_policy_enabled             = true
aks_enable_container_insights        = true

#------------------------------------------------------------------------------
# Bastion Configuration
#------------------------------------------------------------------------------
bastion_vm_size                = "Standard_D2als_v6"
bastion_admin_username         = "azureuser"
bastion_ubuntu_sku             = "22_04-lts-gen2"  # 24.04 not available yet
bastion_allowed_ssh_source_ips = ["0.0.0.0/0"]  # MUST change to specific IPs for production!

# Additional users on bastion (with sudo access)
# Each user can have multiple SSH public keys
bastion_additional_users = {
  # user1 = [
  #   "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC... user1@example.com"
  # ]
}

